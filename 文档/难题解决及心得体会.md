##  难题解决及心得体会

###  难题解决
<br/>
1、数据库的选择与学习

上个学期上过数据库，但当时学的是mysql。但mysql作为关系型数据库，很真正表示一个关系。尤其是本PJ存储思维导图时，mysql很难表示、存储其节点之间的关系。

在思考后，我得出了一些不佳的mysql存储方式（比如为每个思维导图维持一张表，再用一张表存储思维导图的表；或把所有节点放在同一张表中，再在把所有的root_node存储下来做索引）。精益求精之下，我决定去学习Nosql数据库。由于TA推荐使用Neo4j，我就开始了Neo4j的初探。

通过对Neo4j的简单学习，我发现这个数据库有很多优点，比如便于学习、支持UNIQUE、支持ACID、CQL简单易懂等。于是我与小组成员讨论后决定使用Neo4j。

Neo4j的基本概念学习没有什么难度，因为在离散数学等课程中的图论学习中已经对 *图* 有了深刻的认识。但对CQL语句的学习还是比较困难的，毕竟是一门全新的语言，且学习资料较少。感谢yinglish_等等人在博客上的无私分享，才让我能在零基础的情况下摸索使用Neo4j。

博客地址：
> https://blog.csdn.net/yinglish_/article/details/53224133
> 
> https://www.cnblogs.com/hwaggLee/p/5959716.html
>
> https://blog.csdn.net/zxl315/article/details/70174993
> 等

<br/>
<br/>
2、数据库设计

虽然有数据库设计这门课的基础，但毕竟锻炼还是太少。乍一看TA给的PJ文档，还是很难从中提炼出数据库模型的设计。好在TA给了给分点，这下需求就清晰了很多。从而构建出了一个健壮的数据库设计。

3、思维导图组件与angular适配

由于这回前端要求使用angular，而angular与普通的js环境有所差异，导致我们模仿示例文件写代码的结果与预期不同。但是在逐渐摸索的过程中，我们学会了查看控制台信息，通过追踪错误来源，修改了源文件中不合理的地方，解决了类似如关键功能实现文档中提到的如截图功能不正常的问题。

4、文件传输问题

对于上传文件，我们采用了插件ng2-file-upload插件，解决了监视文件上传状态以及文件传输之后更新视图的问题。对于下载文件，我们通过比较不同方案，最终采用了post方式传输文件的方案，将文件先保存为blob格式，再通过模拟点击隐藏的链接下载，保证了文件的安全性。

5、亚马逊服务器的配置问题

 * springboot打包war遇到了404，最后发现是IDEA默认依赖的tomcat版本号为8.5.31，而我的服务器的tomcat版本号为7，产生了不兼容问题。
 * Amazon AWS 免费提供的Ubuntu服务器的内存为1G，按理说是够了的。但是在同时运行了neo4j，前后端都在tomcat上运作时，系统内存严重不足，不到几分钟服务器就崩溃了。重启了几次之后，发现这个问题仍然无法解决。最后在监听内存使用的过程中发现，neo4j中虽然只有1MB数据，但缓存默认要占了接近600M内存。
 	<br> 为了解决内存不足的问题，使用了虚拟内存（共1G），为neo4j配置了虚拟内存，限制了neo4j的最大heap大小256MB。现在配过虚拟内存以后 就算超过物理内存 也不会崩掉。tomcat+neo4j现在加起来用400多MB内存

###  心得体会

**后端：李宗义**
<br>
<br>
Spring作为Java的三大框架之一，我一直没什么动力自己去真正做一个小工程级别的项目。这次总算是逼了自己一把，的的确确是收获颇丰。课堂上理论知识听了很多，落实到项目中后，我才算是掌握了这些知识。比如组件、前后端分离、SpringMVC、SpringBoot框架等等。

在本次项目中，让我感悟最深的可能倒不是框架的学习（这个确实很重要，但由于分工合理，负担反倒没那么重），而是开发过程中的*组员磨合*与对*接口的维护*。

在项目开发的初期，我们必须设定好接口，才能更有针对性的进行编程。然而恰恰是初期，我们对于项目的理解还没有那么深，制定的接口也就只能说是很粗糙；更不用说之后的功能迭代了。在这个基础上，几乎每次编程都会有更改接口的冲动与需求，而沟通的不顺畅、接口的模糊也大大阻碍了我们开发的速度。甚至有的时候，两个人会同时对一份文件进行编译，导致git上传失败（最后我们选择了回退之后重写重传）这个经历告诉了我们，开发过程中要基于同一份接口进行编程，修改必须让前后端双方都知道；良好的沟通很重要，哪怕让一个人纯粹制定接口与保持沟通，也好过大家一窝蜂自顾自的开发；最后，鲁棒的**接口**以及清晰明了的**开发思路/文档**很重要，是顺利开发的基石。

以上是我对本次项目的心得体会。

<br>

**前端：陆怡**
<br>
<br>
大一曾经学习过基础WEB，也自己动手开发过一个相对完整的WEB应用，和这次开发最大的不同是：这次开发是一次工程能力的全面应用。

大一选用的是 ***php*** 脚本语言，导致html与业务数据和业务逻辑高度混杂。对于一个小型应用来说，一个.php文件通常要上百行，如果面向一个大型项目开发的话，一旦业务流程需要更改，代码的更改显然难以完成。

而这次的开发完全实现了 **前后端分离**。在确定了接口规范之后，前端负责页面视图，后端负责数据库建模，前后端的通信完全按照接口实现。在整个开发过程中，前后端各司其职，达到了效率的最大化。

同时，在本次的项目实践中，我认识到了 **框架** 的重要性。一开始觉得框架可能需要学习的时间，但是深入了解之后发现，框架对于我们来说其实只是一个 *黑盒子*，一个大大提高代码效率和优化项目结构的 *黑盒子*。

以我负责的前端为例，***Angular4*** 提出四个新的概念：**组件**－带有业务逻辑和数据的html，**模块**－将应用中不同的部分组织成一个Angular框架可以理解的单元，**指令**－向html元素添加自定义行为，**服务**－封装可重用的业务逻辑。利用组件，我们可以很轻易地将一个完整的页面划分成多个互相可以通信的部分，但组件内部的业务数据和逻辑是独立的，这就可以进一步地将前端分发给不同的人同步完成，非常利于 **模块化开发**。另一方面，组件是由html、css、ts文件共同构成的，可以完全地将业务数据和视图部分分开，当我们需要添加或修改业务逻辑时，直接修改ts文件即可，这就带来了极大的便利。

最后，在这次项目的开发中，我也深刻地体会到了 ***工程化开发*** 的真正意义。四个人既需要协调合作，也需要独立开发，通过git进行版本控制，前期的文档说明也必不可少。比起代码能力的提升，我觉得这部分的收获更为重要。

**吴芸：服务器配置**
<br>
<br>
在整个PJ开发工程中，由于配置这一块主要是由我来做的，所以感触比较深。配置过程中遇到了很多问题。在解决问题期间，甚至 产生了配置要比写后端代码麻烦很多的想法。但是问题在一一解决之后，其实发现配置并没有什么难度，但尤其对细节问题需要注意（如项目依赖的版本号需要对应，预防出现奇怪的问题；对内存、文件的管理）。通过这次PJ，我对linux操作系统，终端命令，以及问题解决思路都有了很大的收获。
此外，在这次工程化开发中，和组员们的合作给我一种取长补短的感觉。我之前不注意的一些方面，如代码的架构风格、文档的整理和开发，迭代的过程，经过这次开发，都注重了很多。



